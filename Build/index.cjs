"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=e(require("node-fetch"));module.exports=class{async Login(e){let n={};try{const o=await t.default("https://www.codingame.com/services/Codingamer/loginSiteV2",{method:"POST",body:JSON.stringify([e.Email,e.Password,!0])});n=await o.json(),this.Cookies=o.headers.raw()["set-cookie"].map((e=>e.split(";")[0])).join(";")}catch(e){return console.warn("There was an error when logging in Error:",e),e}return n.userId||console.warn("No userId was found in the login result:",n),this.User=n,this.UserId=n.userId,n}async FindCodinGamer(e){try{const n=await t.default("https://www.codingame.com/services/CodinGamer/findCodingamerFollowCard",{method:"POST",body:JSON.stringify([e,this.UserId])});return await n.json()}catch(t){console.warn("Something went wrong when getting info on Codingamer",e,"Error:",t)}}async CreateClash(e){if(this.UserId)try{const n=await t.default("https://www.codingame.com/services/ClashOfCode/createPrivateClash",{method:"POST",body:JSON.stringify([this.UserId,{SHORT:!0},[],e||["FASTEST","SHORTEST","REVERSE"]]),headers:{credentials:"same-origin",cookie:this.Cookies}});return await n.json()}catch(e){console.warn("Something went wrong when creating clash Error:",e)}else console.warn("You must be logged in to create clashes")}async GetClash(e){try{const n=await t.default("https://www.codingame.com/services/ClashOfCode/findClashByHandle",{method:"POST",body:JSON.stringify([e])});return await n.json()}catch(t){console.warn("Something went wrong when getting info on clash",e,"Error:",t)}}async GetNotifications(){if(this.UserId)try{const e=await t.default("https://www.codingame.com/services/Notification/findUnreadNotifications",{method:"POST",body:[this.UserId]});return await e.json()}catch(e){console.warn("Something went wrong when retrieving client notifications Error:",e)}else console.log("You must be logged in to check notifications")}async Search(e){try{const n=await t.default("https://www.codingame.com/services/search/search",{method:"POST",body:JSON.stringify([e,"en",null])});return await n.json()}catch(e){console.warn("Something went wrong when trying to search Error:",e)}}async GetUserByHandle(e){try{return await(await t.default("https://www.codingame.com/services/CodinGamer/findCodingamePointsStatsByHandle",{method:"POST",body:JSON.stringify([e])})).json()}catch(t){console.warn("Something went wrong when retrieving Codingamer by handle",e,"Error:",t)}}async GetUserByName(e){const t=await this.Search(e);if(null!=t)for(const n of t)return"USER"===n.type&&n.name===e?await this.GetUserByHandle(n.id):"No user found"}async GetPendingClashes(){try{const e=await t.default("https://www.codingame.com/services/ClashOfCode/findPendingClashes",{method:"POST",body:JSON.stringify([])});return await e.json()}catch(e){console.warn("Something went wrong when getting pending clashes",e)}}constructor(e){e&&e.Email&&e.Password&&this.Login({Email:e.Email,Password:e.Password})}};
